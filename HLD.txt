1.	Tujuan HLD
Dokumen High Level Design ini mendeskripsikan arsitektur sistem, pembagian modul utama, serta alur data tingkat tinggi dari Industrial Weighbridge System sebagai dasar implementasi dan Low Level Design.
2.	Gambaran Arsitektur Sistem
3.	Deskripsi Modul Utama
3.1	Presentation Layer (Desktop User Interface)
Presentation Layer bertanggung jawab atas interaksi pengguna dan penyajian status sistem tanpa mengandung logika bisnis atau aturan penimbangan.
Layer ini hanya berfungsi sebagai command initiator dan state renderer berdasarkan hasil yang diberikan oleh Core Weighing Engine.
A.	Responsibilities
•	Mengirimkan perintah pengguna (command) ke Core Weighing Engine.
•	Menampilkan status sistem dan hasil proses penimbangan.
•	Menyajikan error dan warning yang dihasilkan oleh Core Weighing Engine.
•	Mengelola lifecycle tampilan (screen state, input validation ringan).
B.	Explicit Non-Responsibilities
•	Tidak melakukan pembacaan perangkat keras.
•	Tidak menentukan valid atau tidaknya data berat.
•	Tidak mengelola status transaksi penimbangan.
•	Tidak mengakses Data Layer atau Infrastructure Layer secara langsung.
Presentation Layer bergantung sepenuhnya pada Core Weighing Engine sebagai sumber kebenaran (single source of truth).
3.2	Core Weighing Engine
Core Weighing Engine merupakan pusat logika bisnis dan pengendali utama seluruh siklus penimbangan. Modul ini berperan sebagai otoritas tunggal dalam pengambilan keputusan dan pengelolaan status transaksi.
Core Weighing Engine adalah owner dari seluruh state sistem penimbangan, termasuk status berat, status transaksi, dan status validasi.
A.	Responsibilities
•	Mengelola state transaksi penimbangan (Idle, Weigh-In, Weigh-Out, Completed).
•	Memproses data berat mentah yang diterima dari Infrastructure Layer.
•	Menentukan stabilitas berat berdasarkan parameter konfigurasi.
•	Mengunci berat (weight capture) dan mencegah perubahan setelah dikonfirmasi.
•	Menentukan peran berat (Gross / Tare) berdasarkan konteks transaksi.
•	Menghitung Net Weight.
•	Menerapkan seluruh aturan bisnis penimbangan.
•	Mengorkestrasi interaksi dengan Data Layer dan Infrastructure Layer.
•	Menghasilkan output deterministik untuk Presentation Layer.

B.	Architectural Constraints
•	Tidak ada modul lain yang boleh mengubah state transaksi selain Core Weighing Engine.
•	Seluruh akses ke Data Layer dan Infrastructure Layer harus melalui Core Weighing Engine.
•	Core Weighing Engine tidak bergantung pada implementasi UI atau device tertentu.
3.3	Infrastructure Layer
Infrastructure Layer menyediakan layanan teknis tingkat rendah yang bersifat stateless dan business-agnostic.
Layer ini hanya bertugas menyediakan kemampuan teknis tanpa memahami konteks atau aturan penimbangan.
A.	Responsibilities
•	Membaca data berat mentah dari perangkat timbangan.
•	Menyediakan layanan pencetakan tiket.
•	Menyediakan mekanisme logging dan backup teknis.

B.	Constraints
Infrastructure Layer mencakup komponen berikut:
•	Infrastructure Layer tidak menyimpan state transaksi.
•	Infrastructure Layer tidak melakukan validasi logika bisnis.
•	Infrastructure Layer tidak memiliki pengetahuan tentang alur penimbangan.
3.4	Data Layer
Data Layer bertanggung jawab atas penyimpanan data sistem secara lokal dan persisten.
Layer ini bersifat pasif dan tidak mengandung logika bisnis.
A.	Responsibilities
•	Menyimpan data transaksi penimbangan.
•	Menyimpan master data dan konfigurasi.
•	Menyimpan audit log.

B.	Constraints
•	Data Layer tidak dapat diakses langsung oleh Presentation Layer.
•	Seluruh operasi baca/tulis dilakukan melalui Core Weighing Engine.
•	Konsistensi data dijamin oleh Core Weighing Engine sebagai transactional boundary.

3.5	Dependency Rule
Aturan ketergantungan antar layer ditetapkan sebagai berikut:
•	Presentation Layer hanya bergantung pada Core Weighing Engine.
•	Core Weighing Engine bergantung pada Infrastructure Layer dan Data Layer.
•	Infrastructure Layer dan Data Layer tidak saling bergantung.
•	Tidak ada dependensi terbalik (no upward dependency).
Aturan ini memastikan pemisahan tanggung jawab yang ketat dan mencegah kebocoran logika bisnis ke layer lain.

3.6	Ringkasan Interaksi Antar Layer
Sebagai ringkasan:
•	Presentation Layer hanya berinteraksi dengan Core Weighing Engine.
•	Core Weighing Engine menjadi penghubung tunggal antara UI, Infrastructure Layer, dan Data Layer.
•	Infrastructure Layer dan Data Layer tidak berkomunikasi langsung dengan UI.
Struktur ini memastikan pemisahan tanggung jawab yang jelas, memudahkan pemeliharaan, dan meminimalkan risiko kesalahan logika bisnis.
4.	Alur Data dan Proses Utama Sistem
4.1	Alur Proses Penimbangan Pertama (Weigh-In / Open Transaction)
 
Deskripsi Umum
Alur Weigh-In merupakan proses awal penimbangan yang dilakukan saat kendaraan pertama kali memasuki area jembatan timbang. Proses ini menghasilkan First Weight dan membuka sesi transaksi baru di dalam sistem.
Urutan Proses
1.	Operator memilih menu Penimbangan Pertama (Weigh-In) pada antarmuka pengguna.
2.	Presentation Layer mengirimkan permintaan inisiasi proses Weigh-In ke Core Weighing Engine.
3.	Infrastructure Layer (Serial Communication Handler) membaca data berat mentah dari indikator timbangan secara kontinu.
4.	Data berat mentah diteruskan ke Core Weighing Engine.
5.	Core Weighing Engine:
•	Memvalidasi koneksi perangkat timbangan.
•	Melakukan evaluasi stabilitas berat berdasarkan parameter konfigurasi.
•	Mengubah status sistem menjadi “Stabil” jika kondisi terpenuhi.
6.	Setelah berat dinyatakan stabil, operator menekan tombol Capture Weight.
7.	Core Weighing Engine:
•	Mengunci nilai berat sebagai First Weight.
•	Memvalidasi bahwa kendaraan belum memiliki transaksi aktif (Single Active Transaction Rule).
•	Menyimpan data First Weight beserta metadata (waktu, operator, jenis transaksi) ke Data Layer.
8.	Core Weighing Engine mengembalikan status keberhasilan proses ke Presentation Layer.
9.	Presentation Layer menampilkan konfirmasi bahwa transaksi berhasil dibuka.
Hasil Proses
•	Transaksi baru dengan status Open tercatat di sistem.
•	Nilai First Weight tersimpan dan tidak dapat diubah oleh operator.

4.2	Alur Proses Penimbangan Kedua (Weigh-Out / Close Transaction)
 
Deskripsi Umum
Alur Weigh-Out merupakan proses penimbangan lanjutan yang dilakukan saat kendaraan akan meninggalkan area. Proses ini menutup transaksi dan menghasilkan data Gross Weight, Tare Weight, dan Net Weight.
Urutan Proses
1.	Operator memilih kendaraan dari daftar Transaksi Aktif pada antarmuka pengguna.
2.	Presentation Layer mengirimkan permintaan penutupan transaksi ke Core Weighing Engine.
3.	Infrastructure Layer kembali membaca data berat mentah dari indikator timbangan.
4.	Data berat diteruskan ke Core Weighing Engine untuk diproses.
5.	Core Weighing Engine:
•	Memvalidasi stabilitas berat.
•	Mengunci nilai berat sebagai Second Weight setelah operator melakukan Capture.
6.	Core Weighing Engine menentukan peran berat berdasarkan jenis transaksi:
•	Inbound (Penerimaan)
First Weight → Gross
Second Weight → Tare
•	Outbound (Pengiriman)
First Weight → Tare
Second Weight → Gross
7.	Core Weighing Engine menghitung Net Weight menggunakan selisih absolut antara First Weight dan Second Weight.
8.	Core Weighing Engine melakukan validasi aturan bisnis:
•	Net Weight tidak boleh nol atau negatif.
•	Jenis transaksi tidak boleh diubah.
•	Deteksi anomali berat sesuai konteks transaksi.
9.	Jika validasi berhasil, Core Weighing Engine:
•	Menyimpan data transaksi lengkap ke Data Layer.
•	Mengubah status transaksi menjadi Closed.
10.	Core Weighing Engine mengirimkan perintah pencetakan tiket ke Printer Service melalui Infrastructure Layer.
11.	Presentation Layer menampilkan status bahwa transaksi telah selesai dan tiket berhasil dicetak.
Hasil Proses
•	Transaksi berstatus Closed.
•	Data Gross, Tare, dan Net tersimpan permanen.
•	Tiket penimbangan tercetak sebagai bukti resmi.

4.3	Alur Proses Mode Input Manual (Kondisi Darurat)
 
Deskripsi Umum
Mode Input Manual digunakan sebagai alternatif ketika perangkat timbangan tidak dapat digunakan. Mode ini dikategorikan sebagai kondisi darurat dan diawasi secara ketat oleh sistem.
Urutan Proses
1.	Operator mengajukan aktivasi Mode Manual melalui antarmuka pengguna.
2.	Presentation Layer meminta otorisasi tambahan (password atau alasan tertulis).
3.	Core Weighing Engine:
•	Memverifikasi otorisasi.
•	Menonaktifkan pembacaan otomatis dari perangkat timbangan.
4.	Operator memasukkan nilai berat secara manual.
5.	Core Weighing Engine:
•	Memvalidasi input berat.
•	Menandai transaksi sebagai Manual Weight.
•	Mencatat aktivitas ini ke Audit Log.
6.	Proses Weigh-In atau Weigh-Out dilanjutkan sesuai alur normal.
Hasil Proses
•	Transaksi tercatat dengan penanda manual.
•	Audit log mencatat penggunaan mode darurat.
4.4	Penanganan Kesalahan dan Kondisi Abnormal
Jenis Kondisi
Sistem menangani kondisi berikut:
•	Koneksi perangkat timbangan terputus.
•	Data berat tidak stabil.
•	Data berat tidak valid atau rusak.
•	Pelanggaran aturan bisnis.
Mekanisme Penanganan
•	Core Weighing Engine menghasilkan status kesalahan terstruktur.
•	Presentation Layer menampilkan pesan kesalahan yang sesuai kepada pengguna.
•	Aktivitas kesalahan dicatat ke dalam Audit Log jika bersifat kritis.
4.5	Ringkasan Alur Data
Secara ringkas:
•	Semua data berat mengalir dari Infrastructure Layer → Core Weighing Engine → Presentation Layer.
•	Semua keputusan bisnis dilakukan oleh Core Weighing Engine.
•	Presentation Layer tidak melakukan validasi atau perhitungan berat.

Arsitektur Tingkat Tinggi
 
5.	Spesifikasi Teknologi (Tech Stack)
Berdasarkan kebutuhan sistem operasi Windows dan preferensi pengembangan modern, berikut adalah teknologi yang digunakan:
Komponen	Teknologi Pilihan	Alasan Pemilihan
Language	Kotlin (JVM)	Modern, type-safe, dan interoperabilitas tinggi.
UI Framework	Compose Multiplatform (Desktop)	Pendekatan deklaratif modern, mempermudah pembuatan UI kustom.
Async Process	Kotlin Coroutines & Flow	Menangani data stream RS-232 secara real-time tanpa memblokir UI.
Database	SQLDelight (SQLite)	Ringan, offline-first, dan type-safe query generation.
Hardware Comm	Library jSerialComm	Akses stabil ke port RS-232/USB pada JVM
DI Framework	Koin	Injeksi dependensi yang ringan (minimalist) untuk Kotlin.
Reporting	Apache POI (Excel) / iText (PDF)	Untuk kebutuhan ekspor laporan



